<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kickapoo Tribe Baseball - Walkout Song Picker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #F3BB21; /* Bright yellow background */
            color: #4E321E; /* Dark brown text */
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #4E321E; /* Dark brown header */
            color: #F3BB21; /* Yellow text in header */
            padding: 20px;
            text-align: center;
        }
        header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .main-container {
            display: flex;
            flex-wrap: wrap;
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 10px;
        }
        .sidebar {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border: 2px solid #4E321E;
            border-radius: 8px;
            padding: 20px;
            margin-right: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }
        .sidebar h2 {
            margin-top: 0;
            font-size: 1.5em;
        }
        .song-entry {
            background-color: #F3BB21;
            border: 1px solid #4E321E;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
            position: relative;
        }
        .song-entry button {
            background-color: #4E321E;
            color: #F3BB21;
            border: none;
            border-radius: 3px;
            padding: 5px 10px;
            margin-left: 5px;
            cursor: pointer;
        }
        .song-entry button:hover {
            background-color: #3a2415;
        }
        .form-container {
            flex: 2;
            min-width: 300px;
            background-color: white;
            border: 2px solid #4E321E;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }
        label {
            display: block;
            margin: 10px 0 5px;
            font-weight: bold;
        }
        input[type="text"], input[type="number"] {
            width: 80%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #4E321E;
            border-radius: 5px;
            font-size: 1em;
        }
        button {
            background-color: #4E321E;
            color: #F3BB21;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
        }
        button:hover {
            background-color: #3a2415;
        }
        #searchResults {
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 15px;
        }
        .search-result {
            background-color: #F3BB21;
            border: 1px solid #4E321E;
            padding: 5px;
            margin: 5px 0;
            cursor: pointer;
        }
        .search-result:hover {
            background-color: #e0a91e;
        }
    </style>
</head>
<body>
    <header>
        <h1>Kickapoo Tribe Baseball</h1>
        <p>Walkout Song Picker for Parents</p>
    </header>

    <div class="main-container">
        <!-- Sidebar for Displaying Songs -->
        <div class="sidebar">
            <h2>Selected Walkout Songs</h2>
            <div id="songList"></div>
        </div>

        <!-- Form for Submitting Songs -->
        <div class="form-container">
            <h2>Pick Your Child's Walkout Song</h2>
            <p>Search for a song, select it, and set the start time for your child's walkout song!</p>

            <!-- Search for Songs -->
            <label for="searchQuery">Search Song or Artist:</label>
            <input type="text" id="searchQuery" placeholder="e.g., Sweet Caroline or Neil Diamond">
            <button onclick="searchSongs()">Search</button>

            <!-- Search Results -->
            <div id="searchResults"></div>

            <!-- Form for Song Details -->
            <form id="songForm" onsubmit="addSong(event)">
                <label for="songName">Song Name:</label>
                <input type="text" id="songName" name="songName" placeholder="e.g., Sweet Caroline" required>

                <label for="artist">Artist:</label>
                <input type="text" id="artist" name="artist" placeholder="e.g., Neil Diamond" required>

                <label for="startSecond">Start Second:</label>
                <input type="number" id="startSecond" name="startSecond" min="0" placeholder="e.g., 30" required>

                <button type="submit">Add Song</button>
            </form>
        </div>
    </div>

    <script>
        // Load songs from localStorage when the page loads
        document.addEventListener("DOMContentLoaded", () => {
            displaySongs();
        });

        // Search for songs using The AudioDB API
        async function searchSongs() {
            const query = document.getElementById("searchQuery").value;
            if (!query) {
                alert("Please enter a song or artist name to search.");
                return;
            }

            const searchResults = document.getElementById("searchResults");
            searchResults.innerHTML = "Searching...";

            try {
                // Search by track (song name)
                const trackResponse = await fetch(`https://www.theaudiodb.com/api/v1/json/2/searchtrack.php?s=${encodeURIComponent(query)}&t=${encodeURIComponent(query)}`);
                const trackData = await trackResponse.json();

                // Search by artist as fallback
                const artistResponse = await fetch(`https://www.theaudiodb.com/api/v1/json/2/search.php?s=${encodeURIComponent(query)}`);
                const artistData = await artistResponse.json();

                searchResults.innerHTML = "";
                const tracks = [];

                // Process track search results
                if (trackData.track) {
                    trackData.track.forEach(track => {
                        tracks.push({
                            songName: track.strTrack,
                            artist: track.strArtist
                        });
                    });
                }

                // Process artist search results (get top tracks)
                if (artistData.artists && artistData.artists.length > 0) {
                    const artistId = artistData.artists[0].idArtist;
                    const topTracksResponse = await fetch(`https://www.theaudiodb.com/api/v1/json/2/track-top10.php?s=${artistId}`);
                    const topTracksData = await topTracksResponse.json();
                    if (topTracksData.track) {
                        topTracksData.track.forEach(track => {
                            tracks.push({
                                songName: track.strTrack,
                                artist: track.strArtist
                            });
                        });
                    }
                }

                // Display search results
                if (tracks.length === 0) {
                    searchResults.innerHTML = "<p>No songs found.</p>";
                } else {
                    tracks.forEach(track => {
                        const resultDiv = document.createElement("div");
                        resultDiv.className = "search-result";
                        resultDiv.innerHTML = `${track.songName} by ${track.artist}`;
                        resultDiv.onclick = () => {
                            document.getElementById("songName").value = track.songName;
                            document.getElementById("artist").value = track.artist;
                            searchResults.innerHTML = ""; // Clear search results after selection
                        };
                        searchResults.appendChild(resultDiv);
                    });
                }
            } catch (error) {
                searchResults.innerHTML = "<p>Error searching for songs. Please try again.</p>";
                console.error("Error:", error);
            }
        }

        // Add a song to the list
        function addSong(event) {
            event.preventDefault();

            const songName = document.getElementById("songName").value;
            const artist = document.getElementById("artist").value;
            const startSecond = document.getElementById("startSecond").value;

            const song = {
                name: songName,
                artist: artist,
                start: startSecond
            };

            let songs = JSON.parse(localStorage.getItem("walkoutSongs")) || [];
            songs.push(song);
            localStorage.setItem("walkoutSongs", JSON.stringify(songs));

            displaySongs();
            document.getElementById("songForm").reset();
        }

        // Edit a song
        function editSong(index) {
            let songs = JSON.parse(localStorage.getItem("walkoutSongs")) || [];
            const song = songs[index];

            const newSongName = prompt("Edit Song Name:", song.name);
            const newArtist = prompt("Edit Artist:", song.artist);
            const newStart = prompt("Edit Start Second:", song.start);

            if (newSongName && newArtist && newStart) {
                songs[index] = {
                    name: newSongName,
                    artist: newArtist,
                    start: newStart
                };
                localStorage.setItem("walkoutSongs", JSON.stringify(songs));
                displaySongs();
            }
        }

        // Display the song list
        function displaySongs() {
            const songList = document.getElementById("songList");
            const songs = JSON.parse(localStorage.getItem("walkoutSongs")) || [];

            songList.innerHTML = "";
            if (songs.length === 0) {
                songList.innerHTML = "<p>No songs selected yet.</p>";
            } else {
                songs.forEach((song, index) => {
                    const songDiv = document.createElement("div");
                    songDiv.className = "song-entry";
                    songDiv.innerHTML = `Song: "${song.name}" by ${song.artist}<br>Starting at: ${song.start} seconds<br>`;
                    const editButton = document.createElement("button");
                    editButton.textContent = "Edit";
                    editButton.onclick = () => editSong(index);
                    songDiv.appendChild(editButton);
                    songList.appendChild(songDiv);
                });
            }
        }
    </script>
</body>
</html>
