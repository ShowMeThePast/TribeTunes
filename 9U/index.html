<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kickapoo Tribe Baseball - Walkout Song Picker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #F3BB21;
            color: #4E321E;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #4E321E;
            color: #F3BB21;
            padding: 20px;
            text-align: center;
        }
        header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .main-container {
            display: flex;
            flex-wrap: wrap;
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 10px;
        }
        .sidebar {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border: 2px solid #4E321E;
            border-radius: 8px;
            padding: 20px;
            margin-right: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            position: relative;
        }
        .sidebar h2 {
            margin-top: 0;
            font-size: 1.5em;
        }
        .song-list-container {
            min-height: 100px;
        }
        .song-entry {
            background-color: #F3BB21;
            border: 1px solid #4E321E;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
            position: relative;
        }
        .footer-container {
            flex: 2;
            min-width: 300px;
            padding: 20px;
        }
        footer {
            background-color: #4E321E;
            color: #F3BB21;
            padding: 15px;
            text-align: center;
            font-size: 0.9em;
            margin-top: 20px;
            border-top: 2px solid #F3BB21;
        }
        footer p {
            margin: 0;
        }
    </style>
</head>
<body>
    <header>
        <h1>Kickapoo Tribe Baseball</h1>
        <p>Walkout Song Picker</p>
    </header>

    <div class="main-container">
        <!-- Sidebar for Displaying Songs -->
        <div class="sidebar">
            <h2>Walkout Songs</h2>
            <div class="song-list-container">
                <div id="songList"></div>
            </div>
        </div>

        <!-- Placeholder for footer spacing -->
        <div class="footer-container"></div>
    </div>

    <!-- Footer with Disclaimer -->
    <footer>
        <p><strong>Disclaimer:</strong> The information on this site is provided for convenience and entertainment purposes only. While we strive to update the walkout song selections and player details before each game, changes may occur without notice. For the most accurate and up-to-date information, please consult your head coach at the field. This site was created by the parent of player #26. We are not responsible for any errors, omissions, or discrepancies in the information provided. This site and its content are not intended for use in sports betting, gambling, or any related activities. Any such use is strictly prohibited.</p>
    </footer>

    <script>
        const GOOGLE_SHEETS_API = "https://script.google.com/macros/s/AKfycbxK7tApb4dq_ZbuOwnCwdkPYWclo6EMkdVTq_T5tQxjOjytN84lbeH6duTfbzRv8wes/exec";

        // Load songs from Google Sheets when the page loads
        document.addEventListener("DOMContentLoaded", () => {
            fetchSongs();
            setInterval(checkTimers, 1000);
        });

        // Fetch songs from Google Sheets
        async function fetchSongs() {
            try {
                const response = await fetch(GOOGLE_SHEETS_API, { mode: 'cors' });
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`HTTP error! status: ${response.status} - ${errorText}`);
                }
                const songs = await response.json();
                displaySongs(songs);
            } catch (error) {
                console.error("Error fetching songs:", error);
                document.getElementById("songList").innerHTML = "<p>Error loading songs: " + error.message + ". Check console for details or ensure the web app URL is correct.</p>";
            }
        }

        // Helper function to fetch songs and return them
        async function fetchSongsAndReturn() {
            try {
                const response = await fetch(GOOGLE_SHEETS_API, { mode: 'cors' });
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`HTTP error! status: ${response.status} - ${errorText}`);
                }
                const data = await response.json();
                if (data.error) {
                    throw new Error(`Server error: ${data.error}`);
                }
                return data;
            } catch (error) {
                console.error("Error fetching songs:", error);
                throw error;
            }
        }

        // Display the song list, sorted by battingOrder
        function displaySongs(songs) {
            const songList = document.getElementById("songList");
            songList.innerHTML = "";
            if (!songs || songs.length === 0) {
                songList.innerHTML = "<p>No songs selected yet.</p>";
            } else {
                // Sort songs by battingOrder (ascending)
                songs.sort((a, b) => parseInt(a.battingOrder) - parseInt(b.battingOrder));

                songs.forEach((song, index) => {
                    const songDiv = document.createElement("div");
                    songDiv.className = "song-entry";
                    songDiv.innerHTML = `Child: ${song.childName} (#${song.childNumber})<br>Starting Position: ${song.startingPosition}<br>Batting Order: ${song.battingOrder}<br>Walkout Song: "${song.walkoutSongName}" by ${song.walkoutSongArtistName}<br>Starting at: ${song.startingSecond} seconds<br>`;
                    songList.appendChild(songDiv);
                });
            }
        }

        // Check timers periodically
        function checkTimers() {
            fetchSongs();
        }
    </script>
</body>
</html>
